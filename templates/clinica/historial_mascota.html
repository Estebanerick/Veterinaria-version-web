<!-- templates/clinica/historial_mascota.html -->
{% extends 'base.html' %}

{% block title %}Historial Médico - {{ mascota.nombre }}{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h1>Historial Médico de {{ mascota.nombre }}</h1>
    <div>
        <a href="{% url 'agregar_consulta' %}" class="btn btn-primary">Nueva Consulta</a>
        <a href="{% url 'lista_mascotas' %}" class="btn btn-secondary">Volver a Mascotas</a>
    </div>
</div>

<div class="row">
    <div class="col-md-4">
        <div class="card">
            <div class="card-header">
                <h5>Información de la Mascota</h5>
            </div>
            <div class="card-body">
                <p><strong>Nombre:</strong> {{ mascota.nombre }}</p>
                <p><strong>Especie:</strong> {{ mascota.especie|default:"-" }}</p>
                <p><strong>Raza:</strong> {{ mascota.raza|default:"-" }}</p>
                <p><strong>Fecha Nacimiento:</strong> {{ mascota.fecha_nacimiento|date:"d/m/Y"|default:"-" }}</p>
                <p><strong>Dueño:</strong> {{ mascota.dueno.nombre }}</p>
                <p><strong>Teléfono dueño:</strong> {{ mascota.dueno.telefono|default:"-" }}</p>
            </div>
        </div>
    </div>
    
    <div class="col-md-8">
        <div class="card">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h5>Consultas Médicas ({{ consultas|length }})</h5>
            </div>
            <div class="card-body">
                {% if consultas %}
                    {% for consulta in consultas %}
                    <div class="card mb-3 {% if forloop.first %}border-primary{% endif %}">
                        <div class="card-header">
                            <strong>Consulta del {{ consulta.fecha_consulta|date:"d/m/Y H:i" }}</strong>
                            {% if consulta.veterinario %}
                                <span class="float-end">Veterinario: {{ consulta.veterinario.nombre }}</span>
                            {% endif %}
                        </div>
                        <div class="card-body">
                            <p><strong>Motivo:</strong> {{ consulta.motivo }}</p>
                            
                            {% if consulta.diagnostico %}
                                <p><strong>Diagnóstico:</strong> {{ consulta.diagnostico }}</p>
                            {% endif %}
                            
                            {% if consulta.tratamiento %}
                                <p><strong>Tratamiento:</strong> {{ consulta.tratamiento }}</p>
                            {% endif %}
                            
                            {% if consulta.observaciones %}
                                <p><strong>Observaciones:</strong> {{ consulta.observaciones }}</p>
                            {% endif %}
                            
                            {% if consulta.costo %}
                                <p><strong>Costo:</strong> ${{ consulta.costo }}</p>
                            {% endif %}
                        </div>
                    </div>
                    {% endfor %}
                {% else %}
                    <div class="alert alert-info">
                        <p class="mb-0">No hay consultas registradas para esta mascota.</p>
                    </div>
                {% endif %}
            </div>
        </div>
    </div>
</div>
{% endblock %}