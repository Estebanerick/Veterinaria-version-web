<!-- templates/clinica/lista_duenos_inactivos.html -->
{% extends 'base.html' %}

{% block title %}Due√±os Inactivos - Sistema Veterinaria{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h1>üóÇÔ∏è Due√±os Inactivos</h1>
    <a href="{% url 'lista_duenos' %}" class="btn btn-primary">‚Üê Volver a Due√±os Activos</a>
</div>

{% if messages %}
    {% for message in messages %}
        <div class="alert alert-{{ message.tags }} alert-dismissible fade show">
            {{ message }}
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>
    {% endfor %}
{% endif %}

{% if duenos_inactivos %}
<div class="alert alert-warning">
    <strong>üí° Informaci√≥n:</strong> Estos due√±os fueron eliminados l√≥gicamente y pueden ser restaurados.
</div>

<div class="table-responsive">
    <table class="table table-striped table-hover">
        <thead class="table-warning">
            <tr>
                <th>Nombre</th>
                <th>Tel√©fono</th>
                <th>Email</th>
                <th>Fecha Eliminaci√≥n</th>
                <th>Acciones</th>
            </tr>
        </thead>
        <tbody>
            {% for dueno in duenos_inactivos %}
            <tr>
                <td>
                    <strong>{{ dueno.nombre }}</strong>
                    <br>
                    <small class="text-muted">ID: {{ dueno.id }}</small>
                </td>
                <td>{{ dueno.telefono|default:"-" }}</td>
                <td>{{ dueno.email|default:"-" }}</td>
                <td>
                    {% if dueno.fecha_eliminacion %}
                        {{ dueno.fecha_eliminacion|date:"d/m/Y H:i" }}
                    {% else %}
                        <span class="text-muted">-</span>
                    {% endif %}
                </td>
                <td>
                    <div class="btn-group btn-group-sm">
                        <a href="{% url 'restaurar_dueno' dueno.id %}" 
                           class="btn btn-outline-success" 
                           title="Restaurar due√±o">
                            üîÑ Restaurar
                        </a>
                        <button type="button" 
                                class="btn btn-outline-danger" 
                                title="Eliminar f√≠sicamente (Peligroso)"
                                data-bs-toggle="modal" 
                                data-bs-target="#confirmarEliminarFisico{{ dueno.id }}">
                            üíÄ Eliminar F√≠sico
                        </button>
                    </div>

                    <!-- Modal para eliminaci√≥n f√≠sica (solo para administradores) -->
                    <div class="modal fade" id="confirmarEliminarFisico{{ dueno.id }}" tabindex="-1">
                        <div class="modal-dialog">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title text-danger">üíÄ ELIMINACI√ìN F√çSICA</h5>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                                </div>
                                <div class="modal-body">
                                    <div class="alert alert-danger">
                                        <strong>¬°PELIGRO!</strong> Esta acci√≥n es irreversible.
                                    </div>
                                    <p>¬øEst√°s absolutamente seguro de que deseas <strong>eliminar f√≠sicamente</strong> al due√±o <strong>"{{ dueno.nombre }}"</strong>?</p>
                                    <p class="text-danger">
                                        <strong>Consecuencias:</strong>
                                        <ul>
                                            <li>‚ùå Todos los datos se perder√°n permanentemente</li>
                                            <li>‚ùå No se podr√° recuperar</li>
                                            <li>‚ùå Se eliminar√°n mascotas y consultas asociadas</li>
                                            <li>‚ùå Afectar√° reportes e historiales</li>
                                        </ul>
                                    </p>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                                    <a href="{% url 'eliminar_dueno' dueno.id %}" class="btn btn-danger">
                                        üíÄ S√≠, Eliminar F√≠sicamente
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% else %}
<div class="alert alert-info">
    <h4>‚úÖ No hay due√±os inactivos</h4>
    <p class="mb-0">Todos los due√±os est√°n activos en el sistema.</p>
</div>
{% endif %}
{% endblock %}